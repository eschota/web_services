# Автоматический менеджер прокси

## Описание

Модуль `proxy_manager.py` автоматически загружает, проверяет и управляет рабочими прокси из публичных списков GitHub.

## Функциональность

- ✅ Автоматическая загрузка прокси из 5 источников GitHub
- ✅ Проверка работоспособности прокси на доступность CGTrader.com
- ✅ Автоматическая ротация прокси при отказе
- ✅ Фоновая проверка прокси каждые 5 минут (настраивается)
- ✅ Интеграция с CGTraderHTTPClient

## Источники прокси

1. jetkai/proxy-list (online-proxies/txt/proxies.txt)
2. TheSpeedX/SOCKS-List (socks4.txt)
3. TheSpeedX/SOCKS-List (http.txt)
4. TheSpeedX/SOCKS-List (socks5.txt)
5. MuRongPIG/Proxy-Master (http.txt)

## Настройка

В `config.py` (или через env переменные):

```python
ENABLE_AUTO_PROXY = True  # Включить авто-прокси (по умолчанию True)
PROXY_CHECK_INTERVAL = 300  # Интервал проверки в секундах (5 минут)
MAX_WORKING_PROXIES = 50  # Максимум рабочих прокси в пуле
```

Через env:
```bash
export ENABLE_AUTO_PROXY=true
export PROXY_CHECK_INTERVAL=300
export MAX_WORKING_PROXIES=50
```

## Приоритет прокси

1. **Ручной PROXY_URL** (если задан) - имеет приоритет
2. **Автоматический прокси-менеджер** (если ENABLE_AUTO_PROXY=true)
3. **Без прокси** (если отключено)

## Использование

### Автоматический режим (рекомендуется)

Просто запустите приложение - прокси-менеджер автоматически:
1. Загрузит прокси из источников
2. Проверит их работоспособность
3. Выберет рабочий прокси
4. Будет периодически проверять и ротировать при необходимости

### Ручной режим

Если нужно использовать конкретный прокси:
```bash
export PROXY_URL="http://user:pass@host:port"
export ENABLE_AUTO_PROXY=false
```

## Логирование

Прокси-менеджер логирует:
- Загрузку прокси из источников
- Результаты проверки (рабочие/нерабочие)
- Ротацию прокси
- Ошибки

## Тестирование

```bash
# Быстрый тест (парсинг, структура)
python3 test_proxy_manager.py

# Полный тест (включая загрузку и проверку прокси)
python3 test_proxy_manager.py full
```

## Архитектура

### ProxyChecker
Проверяет доступность прокси на CGTrader.com

### ProxyManager
- Загружает прокси из источников
- Проверяет работоспособность
- Хранит пул рабочих прокси
- Ротирует прокси при отказе
- Фоновая проверка (daemon thread)

### Интеграция с CGTraderHTTPClient
- Автоматическая инициализация при создании клиента
- Обновление прокси перед критическими операциями
- Обработка ошибок прокси с автоматической ротацией
