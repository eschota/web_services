# Исправление алгоритма прокси-менеджера

## Проблема
Пользователь сообщил, что поиск прокси может занимать ЧАСЫ, так как алгоритм проверял все 107,681 прокси последовательно.

## Решение

### 1. Параллельная проверка
- Используется `ThreadPoolExecutor` с 10 параллельными потоками
- Вместо последовательной проверки по одному, проверяется 10 прокси одновременно

### 2. Ограничение количества
- По умолчанию проверяются только первые **200 прокси** (настраивается через `PROXY_MAX_TEST`)
- Вместо всех 107,681 прокси

### 3. Остановка при нахождении
- При быстром старте (`ensure_working_proxy()`) ищется только **1 рабочий прокси**
- Как только найден - останавливается проверка
- Для полного обновления пула можно найти до 10 рабочих (MAX_WORKING_PROXIES)

### 4. Ротация при отказе
- Если текущий прокси перестал работать, автоматически переключается на следующий из пула
- Если все в пуле не работают - обновляется пул (быстрый режим: первые 200)

## Время выполнения

**Было:** ЧАСЫ (107,681 прокси × 10 секунд на проверку = ~300 часов последовательно)

**Стало:** СЕКУНДЫ-МИНУТЫ
- Первые 200 прокси
- 10 параллельно
- Останавливается при первом рабочем

**Ожидаемое время:** 1-5 минут (в зависимости от качества прокси в начале списка)

## Код изменений

Файл: `proxy_manager.py`
- Метод `refresh_working_proxies()` - добавлена параллельная проверка через ThreadPoolExecutor
- Метод `ensure_working_proxy()` - использует fast mode (max_test=200, max_proxies=1)

Файл: `config.py`
- `MAX_WORKING_PROXIES = 10` (уменьшено с 50)
- `PROXY_MAX_TEST = 200` (новый параметр)
